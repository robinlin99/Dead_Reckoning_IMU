import Dead_Reckoning
import numpy.matlib 
import numpy as np 
import math
from mpl_toolkits import mplot3d
import extract

def sim1():
   resolution = 0.0001
   acc1 = [np.array([[4],
      [0],
      [-9.81]])] * 200

   acc2 = [np.array([[-4],
      [0],
      [-9.81]])] * 200

   acc3 = [np.array([[0],
      [0],
      [-9.31]])] * 200

   acc4 = [np.array([[0],
      [0],
      [-10.31]])] * 200

   acc5 = [np.array([[4],
      [0],
      [-9.81]])] * 200

   acc6 = [np.array([[-4],
      [0],
      [-9.81]])] * 200

   acc7 = [np.array([[0],
      [4],
      [-9.81]])] * 200

   acc8 = [np.array([[0],
      [-4],
      [-9.81]])] * 200


   acc = acc1 + acc2 + acc3 + acc4 + acc5 + acc6 + acc7 + acc8
   localAngular = [np.array([[0],
    [0],
    [0]])] * len(acc) 
   steps = len(acc)
   new_sim = Dead_Reckoning.Dead_Reckoning(acc,localAngular,resolution,steps)
   new_sim.simulate()
   new_sim.plot_traj()

def sim2():
   resolution = 0.006
   acc = extract.extract('./B_Accelerometer_data/jog_9/sub_3.csv',"acc")
   localangular = extract.extract('./C_Gyroscope_data/jog_9/sub_3.csv',"gyro")
   acc = acc[0:min(len(acc),len(localangular))]
   localangular = localangular[0:min(len(acc),len(localangular))]
   print(len(acc))
   print(len(localangular))
   assert(len(acc) == len(localangular))
   steps = len(acc)
   new_sim = Dead_Reckoning.Dead_Reckoning(acc, localangular, resolution, steps)
   new_sim.simulate()
   new_sim.plot_traj()

def sim3():
   resolution = 0.002
   g = 9.81
   zacc = [-1.0080108642578125, -1.0072174072265625, -1.0024261474609375, -0.992095947265625, -0.9887542724609375, -0.992462158203125, -0.99530029296875, -0.9990081787109375, -1.00439453125, -1.01031494140625, -1.0143280029296875, -1.010223388671875, -1.00738525390625, -1.0095672607421875, -1.0159454345703125, -1.0208282470703125, -1.0187835693359375, -1.0143585205078125, -1.00799560546875, -1.0045928955078125, -1.0016326904296875, -0.99658203125, -0.981964111328125, -0.96392822265625, -0.9482574462890625, -0.9521484375, -0.9642486572265625, -0.9835052490234375, -1.0083465576171875, -1.0162811279296875, -1.0181427001953125, -1.022613525390625, -1.026702880859375, -1.034881591796875, -1.0380096435546875, -1.0301666259765625, -1.0176544189453125, -1.0031890869140625, -0.9929046630859375, -0.9889068603515625, -0.9944610595703125, -0.9976806640625, -0.9973297119140625, -1.001129150390625, -1.002716064453125, -0.994842529296875, -0.9933319091796875, -0.9930877685546875, -0.9828948974609375, -0.9788360595703125, -0.9831390380859375, -0.989837646484375, -0.9950714111328125, -1.0033721923828125, -1.00146484375, -0.998046875, -1.000885009765625, -1.0046844482421875, -1.0152740478515625, -1.0216064453125, -1.013336181640625, -1.0029754638671875, -0.998687744140625, -1.0052642822265625, -1.031951904296875, -1.0677490234375, -1.1162872314453125, -1.1524658203125, -1.1658935546875, -1.1586151123046875, -1.1255035400390625, -1.0803375244140625, -1.0381317138671875, -1.0154571533203125, -1.0036163330078125, -0.996795654296875, -0.986419677734375, -0.9738006591796875, -0.9673309326171875, -0.9591522216796875, -0.95697021484375, -0.961822509765625, -0.9637451171875, -0.956512451171875, -0.93817138671875, -0.924468994140625, -0.9324493408203125, -0.9429473876953125, -0.9578399658203125, -0.9668731689453125, -0.9516143798828125, -0.934051513671875, -0.9245758056640625, -0.939178466796875, -0.9580078125, -0.99169921875, -1.00531005859375, -1.0134124755859375, -0.98883056640625, -0.9688568115234375, -0.9698028564453125, -0.9671173095703125, -0.9797821044921875, -0.9938812255859375, -1.0103607177734375, -1.0173797607421875, -1.0087127685546875, -0.9892425537109375, -0.9932708740234375, -1.0120086669921875, -1.0201263427734375, -1.0265045166015625, -1.027618408203125, -1.009521484375, -1.006591796875, -1.03765869140625, -1.056854248046875, -1.0671234130859375, -1.0746917724609375, -1.068756103515625, -1.068511962890625, -1.068023681640625, -1.057342529296875, -1.03680419921875, -1.00714111328125, -0.9781951904296875, -0.95379638671875, -0.9372711181640625, -0.94110107421875, -0.946441650390625, -0.9671783447265625, -0.992156982421875, -1.0035400390625, -1.0081939697265625]
   yacc = [-0.036773681640625, -0.0330047607421875, -0.02911376953125, -0.0314178466796875, -0.0294036865234375, -0.03033447265625, -0.0346832275390625, -0.03118896484375, -0.0276947021484375, -0.0316162109375, -0.0356597900390625, -0.03240966796875, -0.0273895263671875, -0.0258941650390625, -0.0226287841796875, -0.023101806640625, -0.0208740234375, -0.0178070068359375, -0.025177001953125, -0.0376434326171875, -0.0389251708984375, -0.0382232666015625, -0.041748046875, -0.0405120849609375, -0.0357513427734375, -0.0327911376953125, -0.040313720703125, -0.038543701171875, -0.0334930419921875, -0.03985595703125, -0.04327392578125, -0.04254150390625, -0.04718017578125, -0.042205810546875, -0.0317230224609375, -0.028717041015625, -0.0252685546875, -0.0230255126953125, -0.023284912109375, -0.0263824462890625, -0.02557373046875, -0.027374267578125, -0.0325469970703125, -0.032012939453125, -0.02978515625, -0.0329132080078125, -0.0278778076171875, -0.0218963623046875, -0.0210418701171875, -0.020172119140625, -0.025970458984375, -0.042266845703125, -0.04693603515625, -0.0395355224609375, -0.036102294921875, -0.03680419921875, -0.0401611328125, -0.0429840087890625, -0.031646728515625, -0.0193939208984375, -0.0178375244140625, -0.0123138427734375, -0.005157470703125, -0.011749267578125, -0.0270538330078125, -0.04083251953125, -0.0499725341796875, -0.0557708740234375, -0.0544281005859375, -0.0484619140625, -0.0341949462890625, -0.02215576171875, -0.019256591796875, -0.024993896484375, -0.02716064453125, -0.0217437744140625, -0.0211334228515625, -0.02325439453125, -0.02191162109375, -0.025390625, -0.0348663330078125, -0.037384033203125, -0.0260772705078125, -0.0189361572265625, -0.0318756103515625, -0.0446319580078125, -0.0391845703125, -0.0295257568359375, -0.0264892578125, -0.024169921875, -0.0079193115234375, 0.00238037109375, -0.0116729736328125, -0.03179931640625, -0.0509185791015625, -0.0452880859375, -0.038970947265625, -0.01788330078125, 0.0028533935546875, 0.028900146484375, 0.022705078125, -0.0187225341796875, -0.0287017822265625, -0.0211029052734375, -0.0135650634765625, -0.027069091796875, -0.0507354736328125, -0.03228759765625, 0.00103759765625, -0.0117034912109375, -0.043701171875, -0.052398681640625, -0.0462646484375, -0.0352020263671875, -0.0064697265625, 0.032196044921875, 0.02581787109375, -0.002471923828125, -0.016387939453125, -0.03009033203125, -0.046844482421875, -0.0644989013671875, -0.081207275390625, -0.0846710205078125, -0.076141357421875, -0.0638885498046875, -0.0597076416015625, -0.058929443359375, -0.0563812255859375, -0.0470123291015625, -0.0418853759765625, -0.0537261962890625, -0.06829833984375, -0.06982421875]
   xacc = [0.012847900390625, 0.00518798828125, 0.0060577392578125, 0.0107421875, 0.0149993896484375, 0.01416015625, 0.0110321044921875, 0.006561279296875, 0.0058135986328125, 0.01226806640625, 0.0219573974609375, 0.020538330078125, 0.0137481689453125, 0.004241943359375, -0.00048828125, 0.0003509521484375, -0.0034332275390625, -0.0072021484375, -0.006683349609375, -0.0024261474609375, -0.014007568359375, -0.0164794921875, -0.01043701171875, -0.0061492919921875, -0.00140380859375, 0.004058837890625, 0.0008697509765625, -0.0111236572265625, -0.0161895751953125, -0.0093536376953125, 0.01080322265625, 0.0257415771484375, 0.029876708984375, 0.0315704345703125, 0.033843994140625, 0.038116455078125, 0.038421630859375, 0.0405731201171875, 0.04718017578125, 0.052093505859375, 0.05352783203125, 0.051605224609375, 0.0505523681640625, 0.0513153076171875, 0.0529327392578125, 0.048187255859375, 0.04351806640625, 0.034332275390625, 0.015625, 0.00634765625, 0.0125274658203125, 0.02313232421875, 0.0194244384765625, 0.0046539306640625, -0.0064697265625, -0.0103302001953125, -0.010223388671875, -0.0215911865234375, -0.0343780517578125, -0.0549774169921875, -0.0740966796875, -0.0944976806640625, -0.1150970458984375, -0.1252899169921875, -0.1356964111328125, -0.162322998046875, -0.1833648681640625, -0.2126922607421875, -0.239105224609375, -0.2484588623046875, -0.2421722412109375, -0.2201080322265625, -0.2025146484375, -0.191680908203125, -0.1915130615234375, -0.1948699951171875, -0.1908721923828125, -0.1970977783203125, -0.190032958984375, -0.1750946044921875, -0.1703338623046875, -0.1801910400390625, -0.197021484375, -0.192291259765625, -0.1812744140625, -0.16009521484375, -0.138214111328125, -0.1299591064453125, -0.142547607421875, -0.1438446044921875, -0.14959716796875, -0.1413116455078125, -0.119476318359375, -0.090057373046875, -0.07574462890625, -0.0582427978515625, -0.04644775390625, -0.036529541015625, -0.061370849609375, -0.1157073974609375, -0.0967254638671875, -0.0761566162109375, -0.060821533203125, -0.0479278564453125, -0.0136871337890625, 0.026275634765625, 0.0106048583984375, -0.0943450927734375, -0.138397216796875, -0.086944580078125, -0.0114593505859375, 0.0406951904296875, 0.0560302734375, 0.053680419921875, 0.0426177978515625, 0.0734710693359375, 0.11248779296875, 0.12677001953125, 0.1061553955078125, 0.072509765625, 0.053619384765625, 0.058807373046875, 0.0751190185546875, 0.0850067138671875, 0.0846099853515625, 0.083404541015625, 0.0872344970703125, 0.0867767333984375, 0.07513427734375, 0.0433807373046875, 0.0369110107421875, 0.060882568359375, 0.0792388916015625, 0.0828094482421875]
   zrot = [0.0006412891671061516, -0.010450243949890137, -0.00899962056428194, -0.004031493328511715, 0.003906857222318649, 0.010416954755783081, 0.01056183036416769, 0.0023254721891134977, -0.003973436541855335, 0.0035028557758778334, 0.010614028200507164, 0.014521950855851173, 0.009295230731368065, 0.008459264412522316, 0.015680426731705666, 0.011242800392210484, 0.004808071069419384, -0.0062397862784564495, -0.002123870886862278, -0.00863023940473795, -0.020617393776774406, -0.02285951003432274, -0.01363431941717863, -0.005672000348567963, 0.007370564620941877, 0.02160569280385971, 0.01537842396646738, -0.012518188916146755, -0.03591778874397278, -0.042019087821245193, -0.03594361990690231, -0.031438883394002914, -0.03736787661910057, -0.04230671003460884, -0.04730546474456787, -0.04700931906700134, -0.040709078311920166, -0.02737436629831791, -0.00890907272696495, 0.0062368568032979965, 0.01139939483255148, 0.013155482709407806, 0.022816099226474762, 0.03616998717188835, 0.05074413865804672, 0.0594492107629776, 0.06276591122150421, 0.049964629113674164, 0.027177825570106506, 0.024704281240701675, 0.03909813240170479, 0.06059703603386879, 0.05672959238290787, 0.040098682045936584, 0.026941869407892227, 0.025106418877840042, 0.037754569202661514, 0.04815847426652908, 0.05168743059039116, 0.050696201622486115, 0.038179341703653336, 0.01900538243353367, 0.013306484557688236, 0.02696317434310913, 0.02532666176557541, -0.00038482676609419286, -0.0351254977285862, -0.10202915966510773, -0.18256394565105438, -0.24496901035308838, -0.2851355969905853, -0.3034059405326843, -0.3112843930721283, -0.3130287528038025, -0.3240172266960144, -0.34827569127082825, -0.3944985866546631, -0.4328606128692627, -0.4441012740135193, -0.443220317363739, -0.45442208647727966, -0.482450008392334, -0.512793242931366, -0.5481869578361511, -0.564490556716919, -0.5546072721481323, -0.5337927937507629, -0.5441418886184692, -0.5629807710647583, -0.5944391489028931, -0.6365735530853271, -0.6536518335342407, -0.6262167692184448, -0.5611738562583923, -0.48717764019966125, -0.41660040616989136, -0.36892345547676086, -0.34657126665115356, -0.4191751480102539, -0.49388375878334045, -0.5072025060653687, -0.48276451230049133, -0.45984455943107605, -0.4131806492805481, -0.3301456868648529, -0.26309633255004883, -0.3363330066204071, -0.5049819350242615, -0.6181793212890625, -0.6190440654754639, -0.5493605732917786, -0.48218342661857605, -0.4365496337413788, -0.4371746778488159, -0.4437295198440552, -0.4246777892112732, -0.3983124792575836, -0.3948730230331421, -0.425252228975296, -0.4705517888069153, -0.4897491931915283, -0.4731212258338928, -0.4316251575946808, -0.39654573798179626, -0.3768676519393921, -0.3566198945045471, -0.32558688521385193, -0.29405906796455383, -0.28642457723617554, -0.2928861975669861, -0.2591077387332916, -0.19953174889087677, -0.14560620486736298, -0.11450154334306717]
   yrot = [0.009052883833646774, 0.01390116848051548, 0.02539830096065998, 0.024443024769425392, 0.015111308544874191, 0.009461412206292152, 0.013038037344813347, 0.01998462714254856, 0.03466610237956047, 0.03753512352705002, 0.05058994144201279, 0.060145363211631775, 0.048828791826963425, 0.03879879415035248, 0.030073747038841248, 0.0317147858440876, 0.053222209215164185, 0.05882789567112923, 0.06402665376663208, 0.06945151090621948, 0.049620017409324646, 0.030177876353263855, 0.014118748717010021, -0.01744290627539158, -0.06106149032711983, -0.07578424364328384, -0.07408647984266281, -0.0838317796587944, -0.07544922083616257, -0.06276218593120575, -0.05594182759523392, -0.03766322135925293, -0.012770390138030052, 0.029855899512767792, 0.04994891583919525, 0.050152115523815155, 0.026043318212032318, -0.004026699345558882, -0.02173032984137535, -0.023992151021957397, -0.014425012283027172, -0.009125587530434132, -0.004412591457366943, -0.009306415915489197, -0.001919073867611587, 0.005738845560699701, 0.024226509034633636, 0.04286197945475578, 0.04609772190451622, 0.020428841933608055, -0.007937018759548664, -0.02106453850865364, -0.014938735403120518, 0.009763681329786777, 0.03332200273871422, 0.027172498404979706, 0.02352769672870636, -0.011952533386647701, -0.04065395146608353, -0.05073215439915657, -0.053474944084882736, -0.05408747121691704, -0.06724854558706284, -0.08680147677659988, -0.09387829154729843, -0.11391671746969223, -0.10336926579475403, -0.09289984405040741, -0.09965495765209198, -0.10221558064222336, -0.1166352704167366, -0.13538499176502228, -0.17116428911685944, -0.20037837326526642, -0.21178334951400757, -0.22324533760547638, -0.24160116910934448, -0.26493340730667114, -0.2836735248565674, -0.3258337676525116, -0.3675639033317566, -0.3901328444480896, -0.4084969460964203, -0.3938831090927124, -0.36798974871635437, -0.34476909041404724, -0.324086993932724, -0.3095269501209259, -0.29816511273384094, -0.25785842537879944, -0.23493421077728271, -0.23146438598632812, -0.23711533844470978, -0.2341214120388031, -0.2509254217147827, -0.24475355446338654, -0.24854430556297302, -0.20805013179779053, -0.1579803079366684, -0.14837588369846344, -0.11711836606264114, -0.11607760190963745, -0.16346482932567596, -0.20751990377902985, -0.2017299234867096, -0.15208274126052856, -0.07036977261304855, -0.03411456197500229, -0.05405151844024658, -0.09429427981376648, -0.13964179158210754, -0.1869152933359146, -0.20895135402679443, -0.21152129769325256, -0.22659052908420563, -0.2140374630689621, -0.18828442692756653, -0.14847682416439056, -0.10527502000331879, -0.06969226151704788, -0.04981549456715584, -0.03255314752459526, -0.012435897253453732, 0.025953836739063263, 0.06692390888929367, 0.10833872109651566, 0.14420723915100098, 0.15515336394309998, 0.12683410942554474, 0.041855305433273315, -0.05463821068406105, -0.11758415400981903, -0.12898407876491547, -0.0856989249587059]
   xrot = [0.009290170855820179, 0.02238866314291954, 0.017342237755656242, 0.004312722943723202, -0.01531876903027296, -0.024216922000050545, -0.026998594403266907, -0.0230571161955595, -0.01296613272279501, -0.0009121326729655266, 0.014647386036813259, 0.019292205572128296, 0.016991499811410904, 0.011869975365698338, 0.009129848331212997, 0.017529193311929703, 0.024636371061205864, 0.028485970571637154, 0.03074299916625023, 0.03741847723722458, 0.049190983176231384, 0.05961832404136658, 0.05374551936984062, 0.025433721020817757, -0.024577248841524124, -0.07619223743677139, -0.10544466972351074, -0.09849674254655838, -0.07934515923261642, -0.06036986783146858, -0.052078913897275925, -0.04694726690649986, -0.024203339591622353, 0.012628177180886269, 0.046612244099378586, 0.058764245361089706, 0.04309767112135887, 0.014347247779369354, -0.002945456188172102, -0.01065370999276638, -0.0076270271092653275, -0.0016961672808974981, 0.0015824503498151898, 0.00649784691631794, 0.013284114189445972, 0.015394669026136398, 0.01974254474043846, 0.002581934677436948, -0.01961977407336235, -0.036613136529922485, -0.04574591666460037, -0.03798839449882507, -0.01116530317813158, 0.011751997284591198, 0.019752666354179382, 0.012471317313611507, 0.007071225438266993, 0.015629826113581657, 0.027299264445900917, 0.028111528605222702, 0.011437743902206421, -0.020378774031996727, -0.05841777101159096, -0.0902036651968956, -0.08680014312267303, -0.04109550639986992, 0.04577174782752991, 0.1433611512184143, 0.23518694937229156, 0.2949030101299286, 0.30510106682777405, 0.267788827419281, 0.20476007461547852, 0.14730262756347656, 0.11777190864086151, 0.10102594643831253, 0.08108925819396973, 0.06484131515026093, 0.04211309924721718, 0.009868077002465725, -0.014946192502975464, -0.018570221960544586, -0.01423353049904108, -0.015282816253602505, -0.025968749076128006, -0.02622734196484089, -0.019845876842737198, -0.019208582118153572, -0.005929261911660433, 0.0005968143814243376, -0.0018836538074538112, -0.026007099077105522, -0.051771052181720734, -0.06281118839979172, -0.04093331843614578, -0.00501073757186532, 0.027209782972931862, 0.047208257019519806, 0.01587936468422413, -0.05188183858990669, -0.11969071626663208, -0.16292180120944977, -0.17429830133914948, -0.16309624910354614, -0.1444019228219986, -0.13040433824062347, -0.14353905618190765, -0.16307520866394043, -0.15681491792201996, -0.13549204170703888, -0.10624761134386063, -0.07472936809062958, -0.055991895496845245, -0.04682715982198715, -0.0407831147313118, -0.047390684485435486, -0.060926735401153564, -0.07902504503726959, -0.07786230742931366, -0.054902661591768265, -0.004706870764493942, 0.06513719260692596, 0.13717517256736755, 0.18988259136676788, 0.2168918251991272, 0.2108057141304016, 0.1720292866230011, 0.12569400668144226, 0.07411257922649384, 0.03346901014447212, 0.013873737305402756, 0.022955648601055145, 0.04785593971610069, 0.08096489310264587]


   rot = []
   for i in range(len(zrot)):
      rot.append(np.array([[xrot[i]],
               [yrot[i]],
               [zrot[i]]]))

   
   acc = []
   for i in range(len(xacc)):
      acc.append(np.array([[xacc[i]*g],
               [yacc[i]*g],
               [zacc[i]*g]]))
   steps = len(acc)
   new_sim = Dead_Reckoning.Dead_Reckoning(acc, rot, resolution, steps)
   new_sim.simulate()
   print(len(zacc))
   new_sim.plot_traj()





if __name__ == "__main__": 
   sim3()
   